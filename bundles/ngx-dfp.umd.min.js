!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("rxjs"),require("@angular/router"),require("rxjs/operators"),require("@alugha/ima")):"function"==typeof define&&define.amd?define("ngx-dfp",["exports","@angular/core","@angular/common","rxjs","@angular/router","rxjs/operators","@alugha/ima"],e):e(t["ngx-dfp"]={},t.ng.core,t.ng.common,t.rxjs,t.ng.router,t.rxjs.operators,null)}(this,function(t,p,c,s,d,f,r){"use strict";var e=function(){function t(){this.isErrorCode=function(t){return"number"==typeof t?!(200<=t&&t<300):"2"!==t[0]}}return t.prototype.httpError=function(t,e){console.log("Error ("+t.status+") "+(e||""))},t.decorators=[{type:p.Injectable}],t}(),n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function o(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function i(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(n=o.next()).done;)s.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=o["return"])&&r.call(o)}finally{if(i)throw i.error}}return s}function a(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t}var u=function(e){function t(t){return e.call(this,"Invalid interval: '"+t+"'ls")||this}return o(t,e),t}(Error),h=function(){function t(){}return t.prototype.convertToMilliseconds=function(t,e){return console.assert(/^(m?s|min|h)$/g.test(e)),"ms"===e?t:"s"===e?1e3*t:"min"===e?60*t*1e3:60*t*60*1e3},t.prototype.convert=function(t){var e=parseFloat(t[1]);return 2===t.length?e:this.convertToMilliseconds(e,t[2])},t.prototype.parseDuration=function(t){if(t===undefined||null===t)throw new u(t);if("number"==typeof t)return t;if("string"!=typeof t)throw new TypeError("'"+t+"' must be of number or string type");var e=t.match(/((?:\d+)?.?\d+)(m?s|min|h)?/);if(!e)throw new u(t);return this.convert(e)},t.decorators=[{type:p.Injectable}],t}(),l=function(){function t(t){this.httpError=t}return t.prototype.completeURL=function(t){return("https:"===document.location.protocol?"https:":"http:")+t},t.prototype.createScript=function(t){var e=document.createElement("script");return e.async=!0,e.type="text/javascript",e.src=this.completeURL(t),e},t.prototype.promiseScript=function(r,n){var e=this,t=new Promise(function(t,e){r.onload=function(){t(r)},r.onerror=function(){e({path:n,loaded:!1})}});return t["catch"](function(t){e.httpError.httpError({status:400},'loading script "'+n+'"')}),t},t.prototype.injectScript=function(t){(document.head||document.querySelector("head")).appendChild(t)},t.prototype.scriptInjector=function(t){var e=this.createScript(t);return this.injectScript(e),this.promiseScript(e,t)},t.decorators=[{type:p.Injectable}],t.ctorParameters=function(){return[{type:e}]},t}(),g=function(){function t(t,e){var r=c.isPlatformBrowser(t)?window:{};r.requestIdleCallback?this.requestIdleCallback=function(t){return r.requestIdleCallback(t)}:this.requestIdleCallback=function(t){return e.runOutsideAngular(function(){return r.setTimeout(t,50)})}}return t.prototype.request=function(t){this.requestIdleCallback(t)},t.decorators=[{type:p.Injectable}],t.ctorParameters=function(){return[{type:Object,decorators:[{type:p.Inject,args:[p.PLATFORM_ID]}]},{type:p.NgZone}]},t}(),y=function(n){function t(t,e,r){return n.call(this,"Incomplete definition of '"+t+"': Missing "+(r?"attribute":"child directive")+" '"+e+"'.")||this}return o(t,n),t}(Error),m=(function(i){function t(t,e,r,n){return i.call(this,"Wrong type for attribute '"+e+"' on directive '"+t+"': Expected "+n+", got "+typeof r)||this}o(t,i)}(Error),function(i){function t(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n;return console.assert(e&&0<e.length),Array.isArray(e[0])&&(e=e[0]),1<e.length?(n=", which must be ",n+=(e=e.map(function(t){return"'"+t+"'"})).slice(0,-1).join(", "),n+=" or "+e[e.length-1]):n=" '"+e[0]+"'",i.call(this,"Invalid use of '"+t+"' directive. Missing parent directive"+n+".")||this}o(t,i)}(Error),function v(){}),I=new p.InjectionToken("dfpConfig",{factory:function(){return new m}}),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(Error),S=function(){function t(t,e,r,n){var i=this;if(this.platformId=t,this.config=r,this.scriptInjector=n,this.enableVideoAds=!1,this.personalizedAds=!0,this.collapseIfEmpty=!0,this.centering=!1,this.location=null,this.ppid=null,this.globalTargeting=null,this.forceSafeFrame=!1,this.safeFrameConfig=null,this.loadGPT=!0,this.loaded=!1,c.isPlatformBrowser(this.platformId)){var o=window,s=o.googletag||{};if(this.dfpConfig(),s.cmd=s.cmd||[],s.cmd.push(function(){i.setup()}),o.googletag=s,this.loadGPT){var a=function(){i.scriptInjector.scriptInjector("//www.googletagservices.com/tag/js/gpt.js").then(function(t){i.loaded=!0})};e?e.request(a):a()}}}return t.prototype.dfpConfig=function(){for(var t in this.config)this.hasOwnProperty(t)&&(this[t]=this.config[t])},t.prototype.addSafeFrameConfig=function(t){if(!this.safeFrameConfig)return!1;if("object"!=typeof this.safeFrameConfig)throw new E("FrameConfig must be an object");t.setSafeFrameConfig(this.safeFrameConfig)},t.prototype.addTargeting=function(t){if(!this.globalTargeting)return!1;if("object"!=typeof this.globalTargeting)throw new E("Targeting must be an object");for(var e in this.globalTargeting)this.globalTargeting.hasOwnProperty(e)&&t.setTargeting(e,this.globalTargeting[e])},t.prototype.addLocation=function(t){if(!this.location)return!1;if("string"!=typeof this.location){if(!Array.isArray(this.location))throw new E("Location must be an array or string");t.setLocation.apply(t,this.location)}else t.setLocation(this.location)},t.prototype.addPPID=function(t){if(!this.ppid)return!1;if("string"!=typeof this.ppid)throw new E("PPID must be a string");t.setPublisherProvidedId(this.ppid)},t.prototype.setup=function(){var t=window.googletag,e=t.pubads();this.enableVideoAds&&e.enableVideoAds(),!1===this.personalizedAds&&e.setRequestNonPersonalizedAds(1),this.collapseIfEmpty&&e.collapseEmptyDivs(),e.disableInitialLoad(),e.setForceSafeFrame(this.forceSafeFrame),e.setCentering(this.centering),this.addLocation(e),this.addPPID(e),this.addTargeting(e),this.addSafeFrameConfig(e),e.enableAsyncRendering(),!0!==this.config.singleRequestMode&&(this.config.enableVideoAds&&e.enableVideoAds(),t.enableServices())},t.prototype.hasLoaded=function(){return this.loaded},t.prototype.defineTask=function(t){c.isPlatformBrowser(this.platformId)&&window.googletag.cmd.push(t)},t.decorators=[{type:p.Injectable}],t.ctorParameters=function(){return[{type:Object,decorators:[{type:p.Inject,args:[p.PLATFORM_ID]}]},{type:g,decorators:[{type:p.Optional}]},{type:m,decorators:[{type:p.Inject,args:[I]}]},{type:l}]},t}(),b=function(){function t(){this.generatedIDs={}}return t.prototype.generateID=function(){var t=null;do{t="gpt-ad-"+Math.random().toString().slice(2)}while(t in this.generatedIDs);return this.generatedIDs[t]=!0,t},t.prototype.dfpIDGenerator=function(t){if(t&&t.id&&!(t.id in this.generatedIDs))return t.id;var e=this.generateID();return t&&(t.id=e),e},t.prototype.isTaken=function(t){return t in this.generatedIDs},t.prototype.isUnique=function(t){return!this.isTaken(t)},t.decorators=[{type:p.Injectable}],t}(),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(Error),A=function(){function t(t,e,r){this.config=t,this.inject=e,this.parseDuration=r,this.refreshEvent=new p.EventEmitter,this.refreshSlots=[],this.intervals={}}return t.prototype.slotRefresh=function(t,e,r){var n=this;void 0===r&&(r=!1);var i=s.from([t]).toPromise(),o={slot:t,deferred:i};return i.then(function(){n.hasSlotInterval(t)&&n.cancelInterval(t),e&&n.addSlotInterval(o,e)}),!0===this.config.singleRequestMode&&r?(this.refreshSlots.push(t),this.singleRequest&&!this.singleRequest.closed&&this.singleRequest.unsubscribe(),this.singleRequest=s.timer(100).subscribe(function(){var t=googletag.pubads();t.enableSingleRequest(),googletag.enableServices(),n.refreshSlots.forEach(function(t){googletag.display(t.getSlotElementId())}),t.refresh(n.refreshSlots),n.refreshSlots=[]})):(googletag.display(t.getSlotElementId()),this.refresh([o])),i},t.prototype.cancelInterval=function(t){if(!this.hasSlotInterval(t))throw new w("No interval for given slot");return this.intervals[this.slotIntervalKey(t)].unsubscribe(),delete this.intervals[t],this},t.prototype.hasSlotInterval=function(t){return this.slotIntervalKey(t)in this.intervals},t.prototype.refresh=function(t){if(t!==undefined)return 0!==t.length&&void googletag.cmd.push(function(){googletag.pubads().refresh(t.map(function(t){return t.slot})),t.forEach(function(t){Promise.resolve(t.slot)})});googletag.cmd.push(function(){googletag.pubads().refresh()})},t.prototype.addSlotInterval=function(e,t){var r=this,n=this.parseDuration.parseDuration(t);this.validateInterval(n,t);var i=s.timer(n,n).subscribe(function(){var t=r.inject.get(c.DOCUMENT);r.hiddenCheck(t.getElementById(e.slot.getSlotElementId()))||(r.refresh([e]),r.refreshEvent.emit(e.slot))});return this.intervals[this.slotIntervalKey(e.slot)]=i},t.prototype.slotIntervalKey=function(t){return t.getSlotId().getDomId()},t.prototype.validateInterval=function(t,e){t<1e3&&console.warn("Careful: ${beforeParsing} is quite a low interval!")},t.prototype.hiddenCheck=function(t){if("undefined"!=typeof window){if("none"===window.getComputedStyle(t).display)return!0;if(t.parentElement)return this.hiddenCheck(t.parentElement)}return!1},t.decorators=[{type:p.Injectable}],t.ctorParameters=function(){return[{type:m,decorators:[{type:p.Optional},{type:p.Inject,args:[I]}]},{type:p.Injector},{type:h}]},t}(),R=function(){function t(t,e,r,n,i,o,s){var a=this;this.platformId=t,this.elementRef=e,this.dfp=r,this.dfpIDGenerator=n,this.dfpRefresh=i,this.config=o,this.afterRefresh=new p.EventEmitter,this.sizes=[],this.responsiveMapping=[],this.targetings=[],this.exclusions=[],this.scripts=[],c.isPlatformBrowser(this.platformId)&&(this.dfpRefresh.refreshEvent.subscribe(function(t){t===a.slot&&a.afterRefresh.emit({type:"refresh",slot:t})}),s&&(this.onSameNavigation=s.events.pipe(f.filter(function(t){return t instanceof d.NavigationEnd})).subscribe(function(t){a.slot&&!a.refresh&&"refresh"===a.config.onSameNavigation&&a.refreshContent.call(a)})))}return t.prototype.ngOnInit=function(){c.isPlatformBrowser(this.platformId)&&this.dfpIDGenerator.dfpIDGenerator(this.elementRef.nativeElement)},t.prototype.ngAfterViewInit=function(){var t=this;c.isPlatformBrowser(this.platformId)&&this.dfp.defineTask(function(){t.defineSlot()})},t.prototype.ngOnDestroy=function(){this.slot&&googletag.destroySlots([this.slot]),this.onSameNavigation&&this.onSameNavigation.unsubscribe()},t.prototype.setResponsiveMapping=function(t){var e=this.getState();if(0!==e.responsiveMapping.length){var r=googletag.sizeMapping();e.responsiveMapping.forEach(function(t){r.addSize(t.viewportSize,t.adSizes)}),t.defineSizeMapping(r.build())}},t.prototype.defineSlot=function(){var e=this,t=this.getState(),r=this.elementRef.nativeElement;this.slot=googletag.defineSlot(t.adUnit,t.sizes,r.id),this.forceSafeFrame!==undefined&&t.forceSafeFrame===!this.config.forceSafeFrame&&this.slot.setForceSafeFrame(t.forceSafeFrame),t.clickUrl&&this.slot.setClickUrl(t.clickUrl),t.collapseIfEmpty&&this.slot.setCollapseEmptyDiv(!0,!0),t.safeFrameConfig&&this.slot.setSafeFrameConfig(JSON.parse(t.safeFrameConfig)),this.slot.renderEnded=function(t){e.afterRefresh.emit({type:"renderEnded",slot:e.slot,data:t})},this.setResponsiveMapping(this.slot),t.targetings.forEach(function(t){e.slot.setTargeting(t.key,t.values)}),t.exclusions.forEach(function(t){e.slot.setCategoryExclusion(t)}),t.scripts.forEach(function(t){t(e.slot)}),this.config.enableVideoAds&&this.slot.addService(googletag.companionAds()),this.slot.addService(googletag.pubads()),this.refreshContent()},t.prototype.refreshContent=function(){var e=this;this.dfpRefresh.slotRefresh(this.slot,this.refresh,!0).then(function(t){e.afterRefresh.emit({type:"init",slot:t})})},t.prototype.checkValid=function(){if(0===this.sizes.length)throw new y("dfp-ad","dfp-size");if(!this.adUnit)throw new y("dfp-ad","ad-unit",!0)},Object.defineProperty(t.prototype,"isHidden",{get:function(){return this.dfpRefresh.hiddenCheck(this.elementRef.nativeElement)},enumerable:!0,configurable:!0}),t.prototype.getState=function(){return this.checkValid(),Object.freeze({sizes:this.sizes,responsiveMapping:this.responsiveMapping,targetings:this.targetings,exclusions:this.exclusions,adUnit:this.adUnit,forceSafeFrame:!0===this.forceSafeFrame,safeFrameConfig:this.safeFrameConfig,clickUrl:this.clickUrl,refresh:this.refresh,scripts:this.scripts,collapseIfEmpty:!0===this.collapseIfEmpty})},t.prototype.addSize=function(t){this.sizes.push(t)},t.prototype.addResponsiveMapping=function(t){this.responsiveMapping.push(t)},t.prototype.addTargeting=function(t){this.targetings.push(t)},t.prototype.addExclusion=function(t){this.exclusions.push(t)},t.prototype.addScript=function(t){this.scripts.push(t)},t.decorators=[{type:p.Directive,args:[{selector:"dfp-ad"}]}],t.ctorParameters=function(){return[{type:Object,decorators:[{type:p.Inject,args:[p.PLATFORM_ID]}]},{type:p.ElementRef},{type:S},{type:b},{type:A},{type:m,decorators:[{type:p.Inject,args:[I]}]},{type:d.Router,decorators:[{type:p.Optional}]}]},t.propDecorators={adUnit:[{type:p.Input}],clickUrl:[{type:p.Input}],forceSafeFrame:[{type:p.Input}],safeFrameConfig:[{type:p.Input}],refresh:[{type:p.Input}],collapseIfEmpty:[{type:p.Input}],afterRefresh:[{type:p.Output}]},t}(),D=function(){function t(t,e,r){var n=this;this.elementRef=t,this.ad=e,this.dfpRefresh=r,this.ad.afterRefresh.subscribe(function(t){n.slot=t.slot})}return t.prototype.normalizeIframe=function(){var e=this;if(this.ad.isHidden)return!1;if(this.iframe=this.iframe||this.getIframe(),!this.iframe)return!1;this.iframeWidth=this.iframeWidth||+this.iframe.width;var r=window.innerWidth,t=this.ad.getState(),n=0;t.sizes.forEach(function(t){t[0]<r&&(n=Math.max(n,t[0]))}),1<t.sizes.length&&n!==this.iframeWidth&&(t=this.ad.getState(),this.iframeWidth=n,this.iframe.setAttribute("width",n+""),this.dfpRefresh.slotRefresh(this.slot,t.refresh).then(function(t){e.ad.afterRefresh.emit({type:"resize",slot:t}),e.iframe=e.getIframe()}))},t.prototype.getIframe=function(){var t=this.elementRef.nativeElement.querySelector("iframe");if(t&&0<+t.width)return t},t.decorators=[{type:p.Directive,args:[{selector:"dfp-ad[responsive]"}]}],t.ctorParameters=function(){return[{type:p.ElementRef},{type:R,decorators:[{type:p.Inject,args:[p.forwardRef(function(){return R})]}]},{type:A}]},t.propDecorators={normalizeIframe:[{type:p.HostListener,args:["window:resize"]}]},t}(),C=function(){function t(t){this.ad=t,this.viewport=[0,0],this.adSizes=[]}return t.prototype.ngOnInit=function(){this.ad.addResponsiveMapping(this.getState())},Object.defineProperty(t.prototype,"viewWidth",{set:function(t){0<t&&(this.viewport[0]=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewHeight",{set:function(t){0<t&&(this.viewport[1]=t)},enumerable:!0,configurable:!0}),t.prototype.addSize=function(t){this.adSizes.push(t)},t.prototype.getState=function(){return Object.freeze({viewportSize:this.viewport,adSizes:this.adSizes})},t.decorators=[{type:p.Directive,args:[{selector:"dfp-responsive"}]}],t.ctorParameters=function(){return[{type:R,decorators:[{type:p.Inject,args:[p.forwardRef(function(){return R})]}]}]},t.propDecorators={viewport:[{type:p.Input}],adSizes:[{type:p.Input}],viewWidth:[{type:p.Input}],viewHeight:[{type:p.Input}]},t}(),P=function(){function t(t,e,r){this.elementRef=t,this.ad=e,this.resp=r}return t.prototype.ngOnInit=function(){var t=this.resp||this.ad,e=this.elementRef.nativeElement.innerText;this.width&&this.height?t.addSize([this.width,this.height]):""!==e.trim()&&t.addSize(e)},t.decorators=[{type:p.Directive,args:[{selector:"dfp-size"}]}],t.ctorParameters=function(){return[{type:p.ElementRef},{type:R,decorators:[{type:p.Inject,args:[p.forwardRef(function(){return R})]}]},{type:C,decorators:[{type:p.Optional},{type:p.Inject,args:[p.forwardRef(function(){return C})]}]}]},t.propDecorators={width:[{type:p.Input}],height:[{type:p.Input}]},t}(),T=function(){function t(t){this.ad=t,this.values=[]}return Object.defineProperty(t.prototype,"value",{set:function(t){var e=this;t instanceof Array?t.forEach(function(t){return e.addValue(t)}):this.addValue(t)},enumerable:!0,configurable:!0}),t.prototype.ngAfterContentInit=function(){var t=this.getState();this.ad.addTargeting(t)},t.prototype.checkValid=function(){if(this.key===undefined)throw new y("dfp-targeting","key",!0);if(0===this.values.length)throw new y("dfp-targeting","value",!0)},t.prototype.getState=function(){return this.checkValid(),Object.freeze({key:this.key,values:this.values})},t.prototype.addValue=function(e){e&&!this.values.find(function(t){return t===e})&&this.values.push(e)},t.decorators=[{type:p.Directive,args:[{selector:"dfp-targeting"}]}],t.ctorParameters=function(){return[{type:R,decorators:[{type:p.Inject,args:[p.forwardRef(function(){return R})]}]}]},t.propDecorators={key:[{type:p.Input}],value:[{type:p.Input}]},t}(),j=function(){function t(t,e){this.elementRef=t,this.ad=e}return t.prototype.ngOnInit=function(){this.ad.addExclusion(this.elementRef.nativeElement.innerText)},t.decorators=[{type:p.Directive,args:[{selector:"dfp-exclusion"}]}],t.ctorParameters=function(){return[{type:p.ElementRef},{type:R,decorators:[{type:p.Inject,args:[p.forwardRef(function(){return R})]}]}]},t}(),M=function(){function t(t,e){this.elementRef=t,this.targeting=e}return t.prototype.ngOnInit=function(){this.targeting.addValue(this.elementRef.nativeElement.innerText)},t.decorators=[{type:p.Directive,args:[{selector:"dfp-value"}]}],t.ctorParameters=function(){return[{type:p.ElementRef},{type:T,decorators:[{type:p.Inject,args:[p.forwardRef(function(){return T})]}]}]},t}(),O=function(){function t(t,e,r,n){this.platformId=t,this.elementRef=e,this.renderer=r,this.dfpIDGenerator=n,this.adEvents=new p.EventEmitter,this.adsDone=!1}return t.prototype.ngOnInit=function(){var e=this;if(c.isPlatformBrowser(this.platformId)){var t=this.elementRef.nativeElement;this.dfpIDGenerator.dfpIDGenerator(t),this.contentPlayer=t.querySelector("video"),this.renderer.setAttribute(this.contentPlayer,"width",this.width.toString()),this.renderer.setAttribute(this.contentPlayer,"height",this.height.toString()),this.adContainer=t.querySelector(".ad-container"),this.adContainer||(this.adContainer=this.renderer.createElement("div"),this.renderer.addClass(this.adContainer,"ad-container"),this.renderer.appendChild(t,this.adContainer)),r.loadImaSdk().then(function(){return e.setUpIMA()}),this.adActions.subscribe(function(t){switch(t){case"play":e.play();break;case"pause":e.pause();break;case"resume":e.resume()}})}},t.prototype.play=function(){this.adsDone||(this.initialUserAction(),this.loadAds(),this.adsDone=!0)},t.prototype.pause=function(){this.adsManager&&this.adsManager.pause()},t.prototype.resume=function(){this.adsManager&&this.adsManager.resume()},t.prototype.setUpIMA=function(){var e=this;this.adDisplayContainer=new google.ima.AdDisplayContainer(this.adContainer,this.contentPlayer),this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer),this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(t){return e.onAdsManagerLoaded(t)},!1),this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,function(t){return e.onAdError(t)},!1),this.contentPlayer.onended=function(){e.contentEnded()}},t.prototype.initialUserAction=function(){this.adDisplayContainer.initialize(),this.contentPlayer.load()},t.prototype.requestAds=function(t){var e=new google.ima.AdsRequest;e.adTagUrl=t,e.linearAdSlotWidth=this.width,e.linearAdSlotHeight=this.height,e.nonLinearAdSlotWidth=this.width,e.nonLinearAdSlotHeight=this.height,this.adsLoader.requestAds(e)},t.prototype.contentEnded=function(){this.contentCompleteCalled=!0,this.adsLoader.contentComplete()},t.prototype.onAdsManagerLoaded=function(t){var e=new google.ima.AdsRenderingSettings;e.restoreCustomPlaybackStateOnAdBreakComplete=!0,this.adsManager=t.getAdsManager(this.contentPlayer,e),this.startAdsManager(this.adsManager)},t.prototype.startAdsManager=function(e){var r=this;e.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,function(){return r.onContentPauseRequested()},!1,this),e.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(){return r.onContentResumeRequested()},!1,this),e.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,function(t){return r.onAdError(t)},!1,this),[google.ima.AdEvent.Type.ALL_ADS_COMPLETED,google.ima.AdEvent.Type.CLICK,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.FIRST_QUARTILE,google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.MIDPOINT,google.ima.AdEvent.Type.PAUSED,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.THIRD_QUARTILE].forEach(function(t){return e.addEventListener(t,function(t){return r.onAdEvent(t)},!1)}),e.init(this.width,this.height,google.ima.ViewMode.NORMAL),e.start()},t.prototype.onContentPauseRequested=function(){this.pauseForAd()},t.prototype.onContentResumeRequested=function(){this.contentCompleteCalled||this.resumeAfterAd()},t.prototype.onAdEvent=function(t){t.type===google.ima.AdEvent.Type.LOADED&&(t.getAd().isLinear()||this.onContentResumeRequested());this.adEvents.emit(t)},t.prototype.onAdError=function(t){this.adsManager&&this.adsManager.destroy(),this.resumeAfterAd(),this.adEvents.emit(t)},t.prototype.resumeAfterAd=function(){this.contentPlayer.play()},t.prototype.pauseForAd=function(){this.contentPlayer.pause()},t.prototype.loadAds=function(){this.requestAds(this.adTag)},t.decorators=[{type:p.Directive,args:[{selector:"dfp-video"}]}],t.ctorParameters=function(){return[{type:Object,decorators:[{type:p.Inject,args:[p.PLATFORM_ID]}]},{type:p.ElementRef},{type:p.Renderer2},{type:b}]},t.propDecorators={width:[{type:p.Input}],height:[{type:p.Input}],adTag:[{type:p.Input}],adActions:[{type:p.Input}],adEvents:[{type:p.Output}]},t}(),L=function(){function t(t,e){this.platformId=t,this.elementRef=e}return t.prototype.ngOnInit=function(){if(c.isPlatformBrowser(this.platformId)){var t=1e13*Math.random(),e="";this.adUnit&&(e="dc_iu="+this.adUnit);var r="";this.ppid&&(r="ppid="+this.ppid);var n=document.createElement("img");n.src="https://pubads.g.doubleclick.net/activity;ord=",n.src+=t+";dc_seg="+this.segmentId+";"+e+r,n.width=1,n.height=1,n.border="0",n.style.visibility="hidden",this.elementRef.nativeElement.append(n)}},t.decorators=[{type:p.Directive,args:[{selector:"dfp-audience-pixel"}]}],t.ctorParameters=function(){return[{type:Object,decorators:[{type:p.Inject,args:[p.PLATFORM_ID]}]},{type:p.ElementRef}]},t.propDecorators={adUnit:[{type:p.Input}],segmentId:[{type:p.Input}],ppid:[{type:p.Input}]},t}(),z=[R,D,P,C,T,j,M,O,L],k=[e,h,l,S,b,A],q=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:a(t&&!0===t.idleLoad?[g]:[],[{provide:I,useValue:t||{}}])}},e.decorators=[{type:p.NgModule,args:[{imports:[],declarations:a(z),providers:a(k),exports:a(z)}]}],e}();t.DfpModule=q,t.HttpErrorService=e,t.ParseDurationService=h,t.ScriptInjectorService=l,t.IdleLoad=g,t.DfpService=S,t.DfpIDGeneratorService=b,t.DfpRefreshService=A,t.DfpAdDirective=R,t.DfpAdResponsiveDirective=D,t.DfpResponsiveDirective=C,t.DfpSizeDirective=P,t.DfpTargetingDirective=T,t.DfpExclusionDirective=j,t.DfpValueDirective=M,t.DfpVideoDirective=O,t.DfpAudiencePixelDirective=L,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-dfp.umd.min.js.map